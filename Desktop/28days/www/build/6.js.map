{"version":3,"sources":["../../src/pages/supporterchat/supporterchat.module.ts","../../src/pages/supporterchat/supporterchat.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SupporterchatPage } from './supporterchat';\n\n@NgModule({\n  declarations: [\n    SupporterchatPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SupporterchatPage),\n  ],\n})\nexport class SupporterchatPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/supporterchat/supporterchat.module.ts","import { Component, AfterViewChecked, ViewChild, NgZone } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Events, Content } from 'ionic-angular';\nimport { ChatProvider } from '../../providers/chat/chat';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\n\n/**\n * Generated class for the SupporterchatPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n@IonicPage()\n@Component({\n  selector: 'page-supporterchat',\n  templateUrl: 'supporterchat.html',\n})\nexport class SupporterchatPage implements AfterViewChecked {\n\t@ViewChild('content') content: Content;\n  inputForm: FormGroup;\n\tbuddy;\n  gogomessages;\n\tchatmessages;\n  showinput = false;\n  constructor(public navCtrl: NavController, public navParams: NavParams, public chat: ChatProvider,\n  \tpublic events: Events, public zone: NgZone, public formBuilder: FormBuilder) {\n    console.log('SupporterchatPage - constructor');\n  \tthis.buddy = this.chat.buddy;\n    this.events.subscribe('newmessage', () => {\n      this.chatmessages = [];\n      this.zone.run(() => {\n        this.chatmessages = this.chat.chatmessages;\n      });\n    });\n    this.inputForm = formBuilder.group({\n      txt: ['', Validators.required]\n    });\n  }\n\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom(){\n    this.content.scrollToBottom(0);\n  }\n\n  ionViewDidLoad() {\n    console.log('SupporterchatPage - ionViewDidLoad');\n    this.chat.checkstart().then((isstart) => {\n      if (isstart) {\n        this.gogomessages = [];\n        this.gogomsg('서포터에게 채팅을 요청했어!\\n확인 후 Push 알림을 줄 거야~!', true).then(() => {\n          this.gogomsg('요즘 가장 해결하고 싶은 고민이 뭐야? 어떤 것 때문에 요청을 하게 됐니?\\n얘기해줄 수 있어?', false).then(() => {\n            this.gogomsg('서포터에게 알려주면 좀 더 편하게 얘기를 할 수 있을 것 같아서~', false).then(() => {\n              setTimeout(() => {\n                this.showinput = true;\n                this.chat.getallmessages();\n              }, 500);\n            });\n          });\n        });\n      } else {\n        this.gogomessages = [\n          this.createmsg(true, '서포터에게 채팅을 요청했어!\\n확인 후 Push 알림을 줄 거야~!', true),\n          this.createmsg(false, '요즘 가장 해결하고 싶은 고민이 뭐야? 어떤 것 때문에 요청을 하게 됐니?\\n얘기해줄 수 있어?', true),\n          this.createmsg(false, '서포터에게 알려주면 좀 더 편하게 얘기를 할 수 있을 것 같아서~', true)\n        ];\n        this.showinput = true;\n        this.chat.getallmessages();\n      }\n    });\n    // this.chat.getallmessages();\n  }\n\n  ionViewWillLeave(){\n    this.events.unsubscribe('newmessage');\n    this.chat.stoplistenmessages();\n  }\n\n  sendmessage() {\n    if (this.inputForm.valid) {\n      var txt = this.inputForm.value.txt;\n      this.inputForm.reset();\n      // if-else for testing only\n      \n      if (txt == 'pay') {\n        this.payMembership();\n      } else {\n        this.chat.sendmessage(txt);\n      }\n    }\n  }\n\n  createmsg(showimage, message, setblack) {\n    return {\n      showimage: showimage,\n      message: message,\n      setblack: setblack\n    };\n  }\n\n  gogomsg(text, showimage) {\n    var promise = new Promise((resolve) => {\n      var msg = this.createmsg(showimage, '메시지를 입력 중입니다.', false);\n      this.gogomessages.push(msg);\n      var count = 0;\n      var intv = setInterval(() => {\n        if (count % 3 == 0) {\n          msg.message = '메시지를 입력 중입니다.';\n        } else if (count % 3 == 1) {\n          msg.message = '메시지를 입력 중입니다..';\n        } else {\n          msg.message = '메시지를 입력 중입니다...';\n        }\n        count++;\n      }, 400);\n      setTimeout(() => {\n        clearInterval(intv);\n        msg.setblack = true;\n        msg.message = text;\n        resolve(true);\n      }, 2000);\n    });\n    return promise;\n  }\n\n  payMembership() {\n    this.navCtrl.push('PaymentPage', {\n      itemName: \"무제한 서포터\",\n      itemPrice: \"9,900\"\n    });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/supporterchat/supporterchat.ts"],"sourceRoot":""}